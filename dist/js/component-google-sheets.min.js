!function(e,t){"use strict";if("function"==typeof define&&define.amd)define(["angular"],t);else{if("undefined"==typeof module||"object"!=typeof module.exports)return t(e.angular);module.exports=t(require("angular"))}}(this,function(e){"use strict";function t(t,n,l){var u={worksheets:{},setWorksheets:function(){return n(function(e,n){var r="https://spreadsheets.google.com/feeds/worksheets/"+o+"/public/values";t({method:"jsonp",url:l.trustAsResourceUrl(r)}).then(function(t){var r=new DOMParser,o=[];try{o=r.parseFromString(t.data,"text/xml").querySelectorAll("entry")}catch(e){n(e)}for(var s=0;s<o.length;s+=1){for(var i={},a=o[s].childNodes,l=0;l<a.length;l+=1)a[l]&&("id"===a[l].tagName.toLowerCase()&&(i.id=a[l].textContent.split("/")[a[l].textContent.split("/").length-1]),"title"===a[l].tagName.toLowerCase()&&(i.title=a[l].textContent));u.worksheets[i.id]=i}e(u.worksheets)},function(e){n(e)})})},read:function(e,r){return n(function(n,s){var i="https://spreadsheets.google.com/feeds/list/"+o+"/"+(e=e||a)+"/public/values";t({method:"jsonp",url:l.trustAsResourceUrl(i)}).then(function(e){var t,o,i=new DOMParser,a=[];try{var l=i.parseFromString(e.data,"text/xml");a=l.querySelectorAll("entry"),t=new Date(l.querySelector("updated").textContent),o=l.querySelector("title").textContent}catch(e){s(e)}for(var u={title:o,lastUpdated:t,entries:{}},c=0;c<a.length;c+=1){for(var d={},f=a[c].childNodes,h=0;h<f.length;h+=1)f[h]&&(f[h].tagName.toLowerCase().indexOf("gsx:")>-1?d[f[h].tagName.split("gsx:")[1]]=f[h].textContent:"id"===f[h].tagName.toLowerCase()&&(d.google_url=f[h].textContent,d.id=d.google_url.split("/")[d.google_url.split("/").length-1]));Object.keys(d).length&&(u.entries[c]=d)}if(r){var g={};for(var p in u.entries)for(var m in r)for(var v in r[m])switch(v){case">":u.entries[p][m]&&parseFloat(u.entries[p][m])>r[m][v]&&(g[p]=u.entries[p]);break;case"<":u.entries[p][m]&&parseFloat(u.entries[p][m])<r[m][v]&&(g[p]=u.entries[p]);break;case">=":u.entries[p][m]&&parseFloat(u.entries[p][m])>=r[m][v]&&(g[p]=u.entries[p]);break;case"<=":u.entries[p][m]&&parseFloat(u.entries[p][m])<=r[m][v]&&(g[p]=u.entries[p]);break;case"like":u.entries[p][m]&&u.entries[p][m].indexOf(r[m][v])>-1&&(g[p]=u.entries[p]);break;default:u.entries[p][m]&&u.entries[p][m]===r[m][v]&&(g[p]=u.entries[p])}return u.entries=g,n(u)}return n(u)},function(e){return s(e)})})},create:function(r,c){for(var d=0;d<r.length;d++){for(var f="",h=0;h<e.toJson(r[d]).length;h++)f+=""+e.toJson(r[d]).charCodeAt(h).toString(16);r[d].confirmationID=(new Date).getTime()+"_"+f}var g="https://script.google.com/a/macros/"+i+"/s/"+s+"/dev?";return c=u.worksheets[c]||u.worksheets[a],g=g+"sheetId="+o+"&sheet="+encodeURIComponent(c.title)+"&data="+encodeURIComponent(e.toJson(r)),n(function(e,n){function o(){u.read(c).then(function(t){for(var o in t.entries)if(t.entries[o].confirmationid===r[0].confirmationID)return e(t);return n(t)})}t({method:"jsonp",url:l.trustAsResourceUrl(g)}).then(o).catch(o)})},init:function(){return clearTimeout(r),n(function(e,n){t?t({method:"get",url:"sheets.config.json"}).then(function(t){o=t.data.sheetId,s=t.data.scriptId,i=t.data.domain,u.setWorksheets(),e(u.worksheets)},function(e){n(e)}):r=setTimeout(function(){u.init()},200)})}};return u.init(),u}var n=e.module("googleSheetsComponent",[]),r=null,o=null,s=null,i=null,a="od6";return t.$inject=["$http","$q","$sce"],n.service("googleSheetsService",t),"googleSheetsComponent"});
//# sourceMappingURL=component-google-sheets.min.js.map
