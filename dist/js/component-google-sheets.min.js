!function(e){function t(e,t,i){var l={worksheets:{},setWorksheets:function(){return t(function(t,r){var o="https://spreadsheets.google.com/feeds/worksheets/"+n+"/public/values";e({method:"jsonp",url:i.trustAsResourceUrl(o)}).then(function(e){var n=new DOMParser,o=[];try{o=n.parseFromString(e.data,"text/xml").querySelectorAll("entry")}catch(e){r(e)}for(var s=0;s<o.length;s+=1){for(var a={},i=o[s].childNodes,c=0;c<i.length;c+=1)i[c]&&("id"===i[c].tagName.toLowerCase()&&(a.id=i[c].textContent.split("/")[i[c].textContent.split("/").length-1]),"title"===i[c].tagName.toLowerCase()&&(a.title=i[c].textContent));l.worksheets[a.id]=a}t(l.worksheets)},function(e){r(e)})})},read:function(r,o){return t(function(t,s){var l="https://spreadsheets.google.com/feeds/list/"+n+"/"+(r=r||a)+"/public/values";e({method:"jsonp",url:i.trustAsResourceUrl(l)}).then(function(e){var r,n,a=new DOMParser,i=[];try{var l=a.parseFromString(e.data,"text/xml");i=l.querySelectorAll("entry"),r=new Date(l.querySelector("updated").textContent),n=l.querySelector("title").textContent}catch(e){s(e)}for(var c={title:n,lastUpdated:r,entries:{}},u=0;u<i.length;u+=1){for(var h={},d=i[u].childNodes,g=0;g<d.length;g+=1)d[g]&&(d[g].tagName.toLowerCase().indexOf("gsx:")>-1?h[d[g].tagName.split("gsx:")[1]]=d[g].textContent:"id"===d[g].tagName.toLowerCase()&&(h.google_url=d[g].textContent,h.id=h.google_url.split("/")[h.google_url.split("/").length-1]));Object.keys(h).length&&(c.entries[u]=h)}if(o){var f={};for(var p in c.entries)for(var m in o)for(var v in o[m])switch(v){case">":c.entries[p][m]&&parseFloat(c.entries[p][m])>o[m][v]&&(f[p]=c.entries[p]);break;case"<":c.entries[p][m]&&parseFloat(c.entries[p][m])<o[m][v]&&(f[p]=c.entries[p]);break;case">=":c.entries[p][m]&&parseFloat(c.entries[p][m])>=o[m][v]&&(f[p]=c.entries[p]);break;case"<=":c.entries[p][m]&&parseFloat(c.entries[p][m])<=o[m][v]&&(f[p]=c.entries[p]);break;case"like":c.entries[p][m]&&c.entries[p][m].indexOf(o[m][v])>-1&&(f[p]=c.entries[p]);break;default:c.entries[p][m]&&c.entries[p][m]===o[m][v]&&(f[p]=c.entries[p])}return c.entries=f,t(c)}return t(c)},function(e){return s(e)})})},create:function(r,c){for(var u=0;u<r.length;u++){for(var h="",d=0;d<angular.toJson(r[u]).length;d++)h+=""+angular.toJson(r[u]).charCodeAt(d).toString(16);r[u].confirmationID=(new Date).getTime()+"_"+h}var g="https://script.google.com/a/macros/"+s+"/s/"+o+"/dev?";return g=g+"sheetId="+n+"&sheet="+encodeURIComponent(l.worksheets[c].title||l.worksheets[a].title)+"&data="+encodeURIComponent(angular.toJson(r)),t(function(t,n){function o(){l.read(c).then(function(e){for(var o in e.entries)if(e.entries[o].confirmationid===r[0].confirmationID)return t(e);return n(e)})}e({method:"jsonp",url:i.trustAsResourceUrl(g)}).then(o).catch(o)})},init:function(){clearTimeout(r),e?e({method:"get",url:"sheets.config.json"}).then(function(e){n=e.data.sheetId,o=e.data.scriptId,s=e.data.domain,l.setWorksheets()}):r=setTimeout(function(){l.init()},200)}};return l.init(),l}var r=null,n=null,o=null,s=null,a="od6";t.$inject=["$http","$q","$sce"],e.service("googleSheetsService",t)}(angular.module("google-sheets-component",[]));
//# sourceMappingURL=component-google-sheets.min.js.map
